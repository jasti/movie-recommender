# ðŸŽ¬ Semantic Movie Recommender

A semantic search engine that recommends the 3 most similar movies to any film â€” powered by sentence-transformers and FAISS, with zero inference cost.

Given a movie, the system encodes its plot, genre, cast, director, and keywords into a single embedding vector, then uses cosine similarity to find the nearest neighbors in ~1ms.

**Live demo:** [https://movie-recommender-991.streamlit.app/](https://movie-recommender-991.streamlit.app/)

## How it works

1. **Rich text construction** â€” For each movie, we build a composite string combining genres, director, top cast, plot overview, and keywords
2. **Embedding** â€” Each string is encoded with `all-MiniLM-L6-v2` (384 dimensions, normalized)
3. **FAISS index** â€” All embeddings are stored in a flat inner-product index for instant similarity search
4. **Streamlit UI** â€” A searchable dropdown with movie poster cards and similarity scores

## Quick start

### 1. Clone and install

```bash
git clone https://github.com/YOUR_USERNAME/movie-recommender.git
cd movie-recommender
pip install -r requirements.txt
```

### 2. Get the movie data

**Option A: TMDB API (recommended â€” no Kaggle account needed)**

1. Create a free account at https://www.themoviedb.org/
2. Go to Settings â†’ API â†’ Request an API Key
3. Run the fetch script:

```bash
python scripts/fetch_tmdb_api.py --api-key YOUR_API_KEY_HERE
```

This fetches ~5,000 popular movies with details, cast, and keywords. Takes ~20 minutes.

**Option B: Kaggle dataset (faster, but needs Kaggle account)**

1. Download the [TMDB 5000 Movie Dataset](https://www.kaggle.com/datasets/tmdb/tmdb-movie-metadata)
2. Place both CSVs in `data/`:

```
data/
â”œâ”€â”€ tmdb_5000_movies.csv
â””â”€â”€ tmdb_5000_credits.csv
```

### 3. Build the index

```bash
python precompute.py
```

Generates embeddings for all movies and saves the FAISS index. Takes ~30-60 seconds on a modern laptop (CPU only).

### 4. Run the app

```bash
streamlit run app.py
```

Open `http://localhost:8501` in your browser.

## Deploy to Streamlit Cloud (free)

1. Push this repo to GitHub (including the `data/` folder with generated files)
2. Go to [share.streamlit.io](https://share.streamlit.io)
3. Connect your GitHub repo â†’ set `app.py` as the entry point
4. Deploy â€” it's live in ~2 minutes

Your app will be available at `https://your-app.streamlit.app`.

**Important:** Make sure `data/faiss_index.bin` and `data/movies_meta.pkl` are committed to the repo. They're only ~8MB total.

## Project structure

```
movie-recommender/
â”œâ”€â”€ data/                        # Dataset + generated index files
â”‚   â”œâ”€â”€ tmdb_5000_movies.csv     # (you download this)
â”‚   â”œâ”€â”€ tmdb_5000_credits.csv    # (you download this)
â”‚   â”œâ”€â”€ faiss_index.bin          # (generated by precompute.py)
â”‚   â””â”€â”€ movies_meta.pkl          # (generated by precompute.py)
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ fetch_tmdb_api.py        # Alternative: fetch data via TMDB API
â”œâ”€â”€ .streamlit/
â”‚   â””â”€â”€ config.toml              # Dark theme config
â”œâ”€â”€ precompute.py                # Data pipeline: parse â†’ embed â†’ index
â”œâ”€â”€ app.py                       # Streamlit web UI
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

## Key design decisions

- **Single combined embedding** â€” Genres, director, cast, plot, and keywords are combined into one text string before embedding. The transformer captures cross-signal relationships naturally.
- **all-MiniLM-L6-v2** â€” 80MB model, ~5000 sentences/sec on CPU. Perfect balance of quality and speed for a demo.
- **FAISS IndexFlatIP** â€” Brute-force inner product search. At ~5K vectors, this is instant and simpler than approximate methods.
- **Pre-computed embeddings** â€” Zero inference cost at runtime. The Streamlit app just does a FAISS lookup.

## Cost breakdown

| Component | Cost |
|-----------|------|
| sentence-transformers model | Free (open source) |
| TMDB data | Free (API or Kaggle) |
| Embedding computation | Free (your laptop, once) |
| Streamlit Cloud hosting | Free |
| **Total** | **$0/month** |

## Built with

- [sentence-transformers](https://www.sbert.net/) â€” Pre-trained text embeddings
- [FAISS](https://github.com/facebookresearch/faiss) â€” Facebook AI Similarity Search
- [Streamlit](https://streamlit.io/) â€” Python web UI
- [TMDB](https://www.themoviedb.org/) â€” Movie data & poster images
